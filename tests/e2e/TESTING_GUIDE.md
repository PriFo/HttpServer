# üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## –û–±–∑–æ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Playwright –¥–ª—è E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —É—Ç–∏–ª–∏—Ç –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ e2e/                          # E2E —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ full-project-e2e.spec.ts  # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç
‚îÇ   ‚îú‚îÄ‚îÄ user-roles.spec.ts        # –¢–µ—Å—Ç—ã —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ quality-management.spec.ts # –¢–µ—Å—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ data-management.spec.ts   # –¢–µ—Å—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ normalization.spec.ts     # –¢–µ—Å—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ monitoring.spec.ts        # –¢–µ—Å—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ reports.spec.ts            # –¢–µ—Å—Ç—ã –æ—Ç—á–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ test-helpers.ts           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ fixtures/                      # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ test-data.ts              # Fixtures –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ data_integrity/               # –¢–µ—Å—Ç—ã —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ performance/                  # –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ resilience/                   # –¢–µ—Å—Ç—ã –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

utils/
‚îú‚îÄ‚îÄ api-testing.ts                # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
‚îú‚îÄ‚îÄ auth-testing.ts               # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md                     # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

scripts/
‚îú‚îÄ‚îÄ run-e2e-tests.sh             # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (Linux/Mac)
‚îî‚îÄ‚îÄ run-e2e-tests.ps1            # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (Windows)
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd frontend
npm install
npx playwright install
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ë—ç–∫–µ–Ω–¥ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
docker-compose up -d backend
# –∏–ª–∏
go run main.go

# –§—Ä–æ–Ω—Ç–µ–Ω–¥ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd frontend
npm run dev
```

### 3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
npx playwright test

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
npx playwright test tests/e2e/full-project-e2e.spec.ts

# –° UI
npx playwright test --ui

# –í –≤–∏–¥–∏–º–æ–º —Ä–µ–∂–∏–º–µ
npx playwright test --headed

# –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (Linux/Mac)
./scripts/run-e2e-tests.sh

# –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (Windows)
.\scripts\run-e2e-tests.ps1
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Ç–∏–ª–∏—Ç

### API Testing (`utils/api-testing.ts`)

```typescript
import {
  createTestClient,
  createTestProject,
  uploadDatabaseFile,
  cleanupTestData,
} from '../../utils/api-testing'

// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
const client = await createTestClient({ name: 'Test Client' })
const project = await createTestProject(client.id, { name: 'Test Project' })

// –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
const dbPath = findTestDatabase()
if (dbPath) {
  const database = await uploadDatabaseFile(client.id, project.id, dbPath)
}

// –û—á–∏—Å—Ç–∫–∞
await cleanupTestData(client.id, project.id, database.id)
```

### Auth Testing (`utils/auth-testing.ts`)

```typescript
import { createAdminToken, createManagerToken } from '../../utils/auth-testing'

// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
const adminToken = createAdminToken()
const managerToken = createManagerToken(123) // clientId

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö
await page.context().setExtraHTTPHeaders({
  Authorization: `Bearer ${adminToken}`,
})
```

### Test Helpers (`tests/e2e/test-helpers.ts`)

```typescript
import { waitForText, clickIfVisible, checkToast } from './test-helpers'

// –û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
await waitForText(page, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ')

// –ö–ª–∏–∫, –µ—Å–ª–∏ –≤–∏–¥–Ω–æ
await clickIfVisible(page, [
  'button:has-text("–ù–∞—á–∞—Ç—å")',
  'button:has-text("Start")',
])

// –ü—Ä–æ–≤–µ—Ä–∫–∞ toast
await checkToast(page, /—É—Å–ø–µ—à–Ω–æ/i, 'success')
```

### Test Fixtures (`tests/fixtures/test-data.ts`)

```typescript
import { getTestClient, getTestProject, findTestDatabase } from '../fixtures/test-data'

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
const client = getTestClient({ name: 'Custom Name' })
const project = getTestProject({ project_type: 'custom' })

// –ü–æ–∏—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
const dbPath = findTestDatabase()
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ beforeAll/afterAll

–í—Å–µ–≥–¥–∞ –æ—á–∏—â–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤:

```typescript
test.beforeAll(async () => {
  // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
})

test.afterAll(async () => {
  // –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  await cleanupTestData(clientId, projectId, databaseId)
})
```

### 2. –ì–∏–±–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Å fallback:

```typescript
const button = page.locator('button:has-text("–ù–∞—á–∞—Ç—å")').or(
  page.locator('button:has-text("Start")')
).first()
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ù–µ –ø–∞–¥–∞–π—Ç–µ –Ω–∞ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö:

```typescript
const hasElement = await element.isVisible({ timeout: 5000 }).catch(() => false)
if (hasElement) {
  // –î–µ–π—Å—Ç–≤–∏–µ
} else {
  console.warn('‚ö†Ô∏è –≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º')
}
```

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```typescript
console.log('‚úÖ –®–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ')
console.warn('‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ')
console.error('‚ùå –û—à–∏–±–∫–∞')
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –Ω–µ —Ç–æ–ª—å–∫–æ –≤ UI, –Ω–æ –∏ —á–µ—Ä–µ–∑ API:

```typescript
const status = await getNormalizationStatus(clientId, projectId)
if (status && status.status === 'running') {
  console.log('‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ')
}
```

## –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏

```bash
npx playwright test --debug
```

### UI —Ä–µ–∂–∏–º

```bash
npx playwright test --ui
```

### Trace viewer

```bash
npx playwright show-trace trace.zip
```

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã

–°–∫—Ä–∏–Ω—à–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤ `test-results/`

## CI/CD

–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ GitHub Actions –ø—Ä–∏ push –≤ main/develop.

–°–º. `.github/workflows/e2e-tests.yml` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## Troubleshooting

### –¢–µ—Å—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —ç–ª–µ–º–µ–Ω—Ç—ã

1. –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `page.waitForLoadState('networkidle')`

### –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `findTestDatabase()` –¥–ª—è –ø–æ–∏—Å–∫–∞

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Playwright Documentation](https://playwright.dev/)
- [API Documentation](../../API_DOCUMENTATION.md)
- [Frontend Navigation Guide](../../FRONTEND_NAVIGATION_AND_API_CHAINS.md)

