# –ê–Ω–∞–ª–∏–∑ —Ü–µ–ø–æ—á–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∫ –∫–ª–∏–µ–Ω—Ç—É

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-26  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –¶–µ–ø–æ—á–∫–∞ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ —É–ª—É—á—à–µ–Ω–∞

## üìã –û–±–∑–æ—Ä —Ü–µ–ø–æ—á–∫–∏

### 1. –§—Ä–æ–Ω—Ç–µ–Ω–¥ - –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏

**–§–∞–π–ª:** `frontend/app/clients/[clientId]/projects/[projectId]/page.tsx`

**–§—É–Ω–∫—Ü–∏—è:** `handleFileUpload` (—Å—Ç—Ä–æ–∫–∞ 316)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ (—Ä–∞–∑–º–µ—Ä, —Ç–∏–ø, –∏–º—è)
2. –°–æ–∑–¥–∞–Ω–∏–µ FormData —Å –ø–æ–ª—è–º–∏:
   - `file` - —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - `auto_create` - —Ñ–ª–∞–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –ë–î
3. –û—Ç–ø—Ä–∞–≤–∫–∞ POST –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ `/api/clients/${clientId}/projects/${projectId}/databases`

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 500MB, –º–∏–Ω–∏–º—É–º 1KB)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ (—Ç–æ–ª—å–∫–æ .db, .sqlite, .sqlite3)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (–∑–∞—â–∏—Ç–∞ –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è database –≤ –æ—Ç–≤–µ—Ç–µ (—Å—Ç—Ä–æ–∫–∞ 559) - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

---

### 2. API Route (Next.js) - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

**–§–∞–π–ª:** `frontend/app/api/clients/[clientId]/projects/[projectId]/databases/route.ts`

**–§—É–Ω–∫—Ü–∏—è:** `POST` (—Å—Ç—Ä–æ–∫–∞ 43)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Content-Type (multipart/form-data)
2. –ü–∞—Ä—Å–∏–Ω–≥ FormData –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ FormData –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥
4. –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥ —Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –ø–æ—Ç–æ–∫
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (15 –º–∏–Ω—É—Ç –¥–ª—è >100MB)
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

### 3. –ë—ç–∫–µ–Ω–¥ - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞

**–§–∞–π–ª:** `server/server_start_shutdown.go`

**–ú–∞—Ä—à—Ä—É—Ç:** `/api/clients/:clientId/projects/:projectId/databases` (—Å—Ç—Ä–æ–∫–∞ 400)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Content-Type:
   - –ï—Å–ª–∏ `multipart/form-data` ‚Üí `handleUploadProjectDatabase`
   - –ï—Å–ª–∏ `application/json` ‚Üí `CreateProjectDatabase` handler
2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `clientID` –∏ `projectID` –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `clientProjectIDWrapper`

---

### 4. –ë—ç–∫–µ–Ω–¥ - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞

**–§–∞–π–ª:** `server/client_legacy_handlers.go`

**–§—É–Ω–∫—Ü–∏—è:** `handleUploadProjectDatabase` (—Å—Ç—Ä–æ–∫–∞ 2913)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É** (—Å—Ç—Ä–æ–∫–∏ 2937-2948)
   - ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ –ë–î
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ `project.ClientID == clientID`
   - ‚úÖ –í–æ–∑–≤—Ä–∞—Ç 400, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–ª–∏–µ–Ω—Ç—É

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞**:
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ Content-Type
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 500MB)
   - ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ multipart —Ñ–æ—Ä–º—ã

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞**:
   - ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ —á–µ—Ä–µ–∑ `filepath.Clean()`
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ path traversal
   - ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ `data/uploads/`

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è SQLite —Ñ–∞–π–ª–∞**:
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ SQLite
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `ValidateSQLiteDatabase()`
   - ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** (—Å—Ç—Ä–æ–∫–∏ 3267-3286):
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `GetProjectDatabaseByFilePath()` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ø—É—Ç–∏
   - ‚úÖ –í–æ–∑–≤—Ä–∞—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞

6. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î** (–µ—Å–ª–∏ `auto_create=true`):
   - ‚úÖ –í—ã–∑–æ–≤ `s.serviceDB.CreateProjectDatabase(projectID, suggestedName, filePath, description, header.Size)`
   - ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É —á–µ—Ä–µ–∑ `projectID` (–∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω)
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø—Ä–∏–≤—è–∑–∫—É
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ø—É—Ç–∏

---

### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏

**–§–∞–π–ª:** `database/service_db.go`

**–§—É–Ω–∫—Ü–∏—è:** `CreateProjectDatabase` (—Å—Ç—Ä–æ–∫–∞ 1924)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ —á–µ—Ä–µ–∑ `filepath.Clean()`
2. –í—Å—Ç–∞–≤–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É `project_databases`:
   - `client_project_id` = `projectID` (–ø—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É)
   - `name` = –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ –∏–º—è
   - `file_path` = –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å
   - `description` = –æ–ø–∏—Å–∞–Ω–∏–µ
   - `file_size` = —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
   - `is_active` = TRUE

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ü—É—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- ‚úÖ –ó–∞–ø–∏—Å—å –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –ø—Ä–æ–µ–∫—Ç—É —á–µ—Ä–µ–∑ `client_project_id`
- ‚úÖ –ü—Ä–æ–µ–∫—Ç —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–ª–∏–µ–Ω—Ç—É —á–µ—Ä–µ–∑ `client_projects.client_id`

---

### 6. –§—Ä–æ–Ω—Ç–µ–Ω–¥ - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞

**–§–∞–π–ª:** `frontend/app/clients/[clientId]/projects/[projectId]/page.tsx`

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. **–ï—Å–ª–∏ `data.database` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç** (—Å—Ç—Ä–æ–∫–∞ 559):
   - ‚úÖ –ë–î —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
   - ‚úÖ –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ

2. **–ï—Å–ª–∏ `data.database` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** (—Å—Ç—Ä–æ–∫–∞ 569):
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ `autoConfirm` –∏ `nameRequired`
   - –ï—Å–ª–∏ `autoConfirm && !nameRequired`:
     - ‚úÖ –í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –ë–î (JSON)
   - –ò–Ω–∞—á–µ:
     - ‚úÖ –ü–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ –ë–î —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π

---

## ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è, –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ –∞–Ω–∞–ª–∏–∑

### 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—É—Ç–∏ –º–æ–≥–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ (Windows/Linux), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ü—É—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `filepath.Clean()` –≤ `CreateProjectDatabase`
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ `GetProjectDatabaseByFilePath` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ø—É—Ç–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ `CreateProjectDatabase` handler —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—É—Ç–µ–π

**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `database/service_db.go` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ –≤ `CreateProjectDatabase`
- `database/service_db.go` - —É–ª—É—á—à–µ–Ω–∞ `GetProjectDatabaseByFilePath`
- `server/handlers/clients.go` - —É–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- `server/client_legacy_handlers.go` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –º–æ–≥–ª–∞ –Ω–µ –Ω–∞–π—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ë–î –∏–∑-–∑–∞ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ø—É—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ `GetProjectDatabaseByFilePath` —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—É—Ç–∏ (original, normalized, slash, backslash)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ handler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏

---

## üîó –°—Ö–µ–º–∞ —Ü–µ–ø–æ—á–∫–∏

```
[Frontend: handleFileUpload]
         ‚Üì
    [FormData: file + auto_create]
         ‚Üì
[API Route: POST /api/clients/:clientId/projects/:projectId/databases]
         ‚Üì
    [–ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±—ç–∫–µ–Ω–¥]
         ‚Üì
[Backend Router: –ø—Ä–æ–≤–µ—Ä–∫–∞ Content-Type]
         ‚Üì
[handleUploadProjectDatabase]
         ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É ‚úÖ
         ‚îú‚îÄ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ ‚úÖ
         ‚îú‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ ‚úÖ
         ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (—É–ª—É—á—à–µ–Ω–∞) ‚úÖ
         ‚îî‚îÄ‚Üí [–ï—Å–ª–∏ auto_create=true]
                 ‚Üì
         [CreateProjectDatabase]
                 ‚îú‚îÄ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ ‚úÖ
                 ‚îî‚îÄ‚Üí INSERT –≤ project_databases
                     ‚îî‚îÄ‚Üí client_project_id = projectID ‚úÖ
                         ‚îî‚îÄ‚Üí project.client_id = clientID ‚úÖ
                             ‚îî‚îÄ‚Üí –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É! ‚úÖ
```

---

## ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ (—Å—Ç—Ä–æ–∫–∞ 2944)
2. **Path traversal** –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ `filepath.Clean()` –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è SQLite** —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –¥—É–±–ª–µ–π
5. **–û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤** - —Ñ–∞–π–ª —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

---

## üìù –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–±—É–¥—É—â–∏–µ)

1. –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ + —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
2. –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¶–µ–ø–æ—á–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∫ –∫–ª–∏–µ–Ω—Ç—É –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ —É–ª—É—á—à–µ–Ω–∞:

1. ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –º–µ—Å—Ç–µ
2. ‚úÖ –ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
3. ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
4. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
5. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
6. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ

