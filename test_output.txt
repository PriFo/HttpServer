=== RUN   TestCounterpartyNormalization_E2E_FullCycle
2025/11/26 00:48:47 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:47 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:47 Creating indexes for stage tracking...
2025/11/26 00:48:47 Stage indexes created: 25 new indexes
2025/11/26 00:48:47 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:47 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:47 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:47 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:47 Running migration: creating normalization_sessions table...
2025/11/26 00:48:47 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:47 Running migration: creating normalization_sessions table...
2025/11/26 00:48:47 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:47 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:47 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:47 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:47 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:47 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:47 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:47 No saved config found, using default config
2025/11/26 00:48:47 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:47   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:47   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:47   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:47   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:47   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:47   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:47   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:47   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:47   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:47   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:47   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:47   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:47   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:47   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:47   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:47   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:47   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:47   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:47 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:47 source_id column already exists, skipping migration
2025/11/26 00:48:47   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:47   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:47   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:47   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:47 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:47 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:47 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:47 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:47 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:47 source_id column already exists, skipping migration
2025/11/26 00:48:47 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:47 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:47 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:47 Creating indexes for stage tracking...
2025/11/26 00:48:47 Stage indexes created: 25 new indexes
2025/11/26 00:48:47 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:47 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:47 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:47 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:47 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:47 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:47 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:47 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:47 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:47 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:47 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:47 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:47 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:47 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:47 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:47 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:47 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:47 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:47 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:47 [DEBUG] counterpartyHandler status: &{0xc000514a80 0xc00057e540 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:47 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:47 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 INFO Getting client client_id=1
2025/11/26 00:48:47 INFO Getting client project client_id=1 project_id=1
2025/11/26 00:48:47 Starting normalization for client_id=1, project_id=1, databases_count=1, all_active=false, selected_ids=[]
[2025/11/26 - 00:48:47] 192.0.2.1 [POST] /api/clients/1/projects/1/normalization/start 200 527.2┬╡s 92 [RequestID: f1bcbb2e-9d1c-4dd9-aa6c-dfd83358ea0b]
2025/11/26 00:48:47 [Counterparty] Using global MaxWorkers=2 for parallel processing
[GIN] Request ID: f1bcbb2e-9d1c-4dd9-aa6c-dfd83358ea0b
2025/11/26 00:48:47 [Counterparty] Starting parallel normalization for project 1: 1 databases, 1 workers
2025/11/26 00:48:47 Error checking database file :memory:: CreateFile :memory:: The filename, directory name, or volume label syntax is incorrect., skipping
2025/11/26 00:48:47 [Counterparty] Database test_db processing completed in 524.2┬╡s
2025/11/26 00:48:47 [Counterparty] All databases processed for project 1: total=1, duration=524.2┬╡s, avg_time_per_db=0s, completed: 0, failed: 0
2025/11/26 00:48:47 Normalization completed for project 1
[2025/11/26 - 00:48:47] 192.0.2.1 [POST] /api/normalization/stop 200 0s 71 [RequestID: ab097d12-daab-412b-9c9c-101d1b8799cb]
[GIN] Request ID: ab097d12-daab-412b-9c9c-101d1b8799cb
[2025/11/26 - 00:48:47] 192.0.2.1 [GET] /api/normalization/status 200 0s 105 [RequestID: 2b433135-41a5-4bc7-95bd-c154db73982a]
[GIN] Request ID: 2b433135-41a5-4bc7-95bd-c154db73982a
--- PASS: TestCounterpartyNormalization_E2E_FullCycle (0.58s)
=== RUN   TestCounterpartyNormalization_E2E_API_Contract
2025/11/26 00:48:47 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:47 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:47 Creating indexes for stage tracking...
2025/11/26 00:48:47 Stage indexes created: 25 new indexes
2025/11/26 00:48:47 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:47 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:47 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:47 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:47 Running migration: creating normalization_sessions table...
2025/11/26 00:48:47 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:47 Running migration: creating normalization_sessions table...
2025/11/26 00:48:47 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:47 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:47 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:47 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:47 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:47 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:47 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:47 No saved config found, using default config
2025/11/26 00:48:47 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:47   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:47   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:47   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:47   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:47   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:47   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:47   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:47   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:47   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:47   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:47   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:47   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:47   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:47   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:47   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:47   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:47   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:47   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:47 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:47 source_id column already exists, skipping migration
2025/11/26 00:48:47   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:47   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:47   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:47   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:47 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:47 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:47 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:47 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:47 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:47 source_id column already exists, skipping migration
2025/11/26 00:48:47 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:47 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:47 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:47 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:47 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:47 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:47 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:47 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:47 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:47 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:47 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:47 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:47 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:47 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:47 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:47 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:47 [DEBUG] counterpartyHandler status: &{0xc000515ba8 0xc000dce4e0 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:47 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:47 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:47 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:47 INFO Getting client client_id=1
2025/11/26 00:48:47 INFO Getting client project client_id=1 project_id=1
2025/11/26 00:48:47 Starting normalization for client_id=1, project_id=1, databases_count=1, all_active=true, selected_ids=[]
2025/11/26 00:48:47 [Counterparty] Using global MaxWorkers=2 for parallel processing
2025/11/26 00:48:47 [Counterparty] Starting parallel normalization for project 1: 1 databases, 1 workers
[2025/11/26 - 00:48:47] 192.0.2.1 [POST] /api/clients/1/projects/1/normalization/start 200 0s 92 [RequestID: 5ab4fff3-c2e2-4377-b152-ffd10cc39547]
[GIN] Request ID: 5ab4fff3-c2e2-4377-b152-ffd10cc39547
[2025/11/26 - 00:48:47] 192.0.2.1 [POST] /api/normalization/stop 200 0s 71 [RequestID: 33abdcb9-c749-4d51-abef-4fdbb478b04d]
[GIN] Request ID: 33abdcb9-c749-4d51-abef-4fdbb478b04d
2025/11/26 00:48:47 Error checking database file :memory:: CreateFile :memory:: The filename, directory name, or volume label syntax is incorrect., skipping
2025/11/26 00:48:47 [Counterparty] Database test_db processing completed in 0s
2025/11/26 00:48:47 [Counterparty] All databases processed for project 1: total=1, duration=0s, avg_time_per_db=0s, completed: 0, failed: 0
2025/11/26 00:48:47 Normalization completed for project 1
--- PASS: TestCounterpartyNormalization_E2E_API_Contract (0.24s)
=== RUN   TestCounterpartyNormalization_StartStop
2025/11/26 00:48:48 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:48 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:48 Creating indexes for stage tracking...
2025/11/26 00:48:48 Stage indexes created: 25 new indexes
2025/11/26 00:48:48 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:48 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:48 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:48 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:48 Running migration: creating normalization_sessions table...
2025/11/26 00:48:48 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:48 Running migration: creating normalization_sessions table...
2025/11/26 00:48:48 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:48 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:48 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:48 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:48 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:48 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:48 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:48 No saved config found, using default config
2025/11/26 00:48:48 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:48   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:48   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:48   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:48   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:48   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:48   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:48   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:48   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:48   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:48   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:48   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:48   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:48   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:48   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:48   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:48   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:48   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:48   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:48 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:48 source_id column already exists, skipping migration
2025/11/26 00:48:48   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:48   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:48   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:48   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:48 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:48 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:48 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:48 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:48 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:48 source_id column already exists, skipping migration
2025/11/26 00:48:48 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:48 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:48 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:48 Creating indexes for stage tracking...
2025/11/26 00:48:48 Stage indexes created: 25 new indexes
2025/11/26 00:48:48 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:48 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:48 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:48 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:48 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:48 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:48 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:48 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:48 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:48 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:48 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:48 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:48 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:48 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:48 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:48 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:48 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:48 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:48 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:48 [DEBUG] counterpartyHandler status: &{0xc000008d50 0xc000ecd6e0 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:48 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:48 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:48 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:48 INFO Getting client client_id=1
2025/11/26 00:48:48 INFO Getting client project client_id=1 project_id=1
2025/11/26 00:48:48 Starting normalization for client_id=1, project_id=1, databases_count=1, all_active=true, selected_ids=[]
2025/11/26 00:48:48 [Counterparty] Using global MaxWorkers=2 for parallel processing
[2025/11/26 - 00:48:48] 192.0.2.1 [POST] /api/clients/1/projects/1/normalization/start 200 568.7┬╡s 92 [RequestID: 978c7499-090c-4661-80df-e4cf281a3084]
2025/11/26 00:48:48 [Counterparty] Starting parallel normalization for project 1: 1 databases, 1 workers
[GIN] Request ID: 978c7499-090c-4661-80df-e4cf281a3084
2025/11/26 00:48:48 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:48 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:48 Creating indexes for stage tracking...
2025/11/26 00:48:48 Stage indexes created: 25 new indexes
2025/11/26 00:48:48 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:48 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:48 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:48 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:48 No counterparties found in database Test Database (project 1)
2025/11/26 00:48:48 [Counterparty] Database Test Database processing completed in 5.3292ms
2025/11/26 00:48:48 [Counterparty] All databases processed for project 1: total=1, duration=5.3292ms, avg_time_per_db=5.3292ms, completed: 1, failed: 0
2025/11/26 00:48:48 Normalization completed for project 1
[2025/11/26 - 00:48:48] 192.0.2.1 [POST] /api/clients/1/projects/1/normalization/stop 200 0s 71 [RequestID: dda7cca6-907f-448f-9b90-35959db024d0]
[GIN] Request ID: dda7cca6-907f-448f-9b90-35959db024d0
[2025/11/26 - 00:48:48] 192.0.2.1 [GET] /api/normalization/status 200 0s 105 [RequestID: ce5df568-a903-4e80-95d1-a061b9d58419]
[GIN] Request ID: ce5df568-a903-4e80-95d1-a061b9d58419
--- PASS: TestCounterpartyNormalization_StartStop (0.95s)
=== RUN   TestCounterpartyNormalization_ProcessCounterpartyDatabase
2025/11/26 00:48:49 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:49 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:49 Creating indexes for stage tracking...
2025/11/26 00:48:49 Stage indexes created: 25 new indexes
2025/11/26 00:48:49 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:49 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:49 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:49 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:49 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:49 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:49 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:49 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:49 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:49 No saved config found, using default config
2025/11/26 00:48:49 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:49   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:49   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:49   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:49   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:49   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:49   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:49   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:49   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:49   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:49   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:49   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:49   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:49   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:49   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:49   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:49   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:49   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:49   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:49   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:49   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:49   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:49 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:49 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:49 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:49 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:49 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:49 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:49 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:49 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:49 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:49 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:49 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:49 [DEBUG] counterpartyHandler status: &{0xc000009d40 0xc000fd3b00 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:49 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:49 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/clients/1/projects/1/normalization/stop 200 0s 71 [RequestID: 9d516087-8502-4153-a825-ad86a3b8b8cd]
[GIN] Request ID: 9d516087-8502-4153-a825-ad86a3b8b8cd
    counterparty_normalization_integration_test.go:267: Expected session status 'stopped' or 'completed', got running
--- FAIL: TestCounterpartyNormalization_ProcessCounterpartyDatabase (0.08s)
=== RUN   TestCounterpartyNormalization_ParallelWorkers
2025/11/26 00:48:49 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:49 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:49 Creating indexes for stage tracking...
2025/11/26 00:48:49 Stage indexes created: 25 new indexes
2025/11/26 00:48:49 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:49 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:49 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:49 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:49 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:49 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:49 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:49 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:49 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:49 No saved config found, using default config
2025/11/26 00:48:49 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:49   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:49   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:49   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:49   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:49   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:49   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:49   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:49   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:49   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:49   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:49   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:49   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:49   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:49   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:49   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:49   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:49   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:49   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:49   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:49   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:49   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:49 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:49 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:49 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:49 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:49 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:49 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:49 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:49 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:49 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:49 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:49 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:49 [DEBUG] counterpartyHandler status: &{0xc001180df8 0xc0012220c0 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:49 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:49 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/clients/1/projects/1/normalization/stop 200 0s 71 [RequestID: 87c7c7ec-cab0-423c-a4b2-acbc0c29439e]
[GIN] Request ID: 87c7c7ec-cab0-423c-a4b2-acbc0c29439e
--- PASS: TestCounterpartyNormalization_ParallelWorkers (0.33s)
=== RUN   TestFullNormalizationFlow
2025/11/26 00:48:49 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:49 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:49 Creating indexes for stage tracking...
2025/11/26 00:48:49 Stage indexes created: 25 new indexes
2025/11/26 00:48:49 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:49 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:49 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:49 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:49 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:49 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:49 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:49 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:49 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:49 No saved config found, using default config
2025/11/26 00:48:49 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:49   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:49   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:49   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:49   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:49   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:49   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:49   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:49   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:49   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:49   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:49   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:49   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:49   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:49   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:49   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:49   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:49   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:49   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:49   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:49   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:49   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:49 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:49 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
=== RUN   TestFullNormalizationFlow/StartNormalization
2025/11/26 00:48:49 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:49 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:49 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:49 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:49 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:49 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:49 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:49 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:49 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:49 [DEBUG] counterpartyHandler status: &{0xc001181aa0 0xc0012ea0c0 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:49 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:49 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/normalization/start 200 0s 106 [RequestID: f465130a-7970-415c-8f23-060c22c0ac0d]
[GIN] Request ID: f465130a-7970-415c-8f23-060c22c0ac0d
=== RUN   TestFullNormalizationFlow/ApplyPatterns
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/normalization/start 200 519.3┬╡s 106 [RequestID: ccc87cb6-ad9e-46f1-8661-f7420fa69e53]
[GIN] Request ID: ccc87cb6-ad9e-46f1-8661-f7420fa69e53
2025/11/26 00:48:49 ERROR HTTP error error="Failed to apply patterns: ╨Т╨╜╤Г╤В╤А╨╡╨╜╨╜╤П╤П ╨╛╤И╨╕╨▒╨║╨░ ╤Б╨╡╤А╨▓╨╡╤А╨░: ╨╜╨╡ ╤Г╨┤╨░╨╗╨╛╤Б╤М ╨┐╤А╨╕╨╝╨╡╨╜╨╕╤В╤М ╨┐╨░╤В╤В╨╡╤А╨╜╤Л\nfailed to persist normalized name: failed to update normalized name via catalog_item: no such column: normalized_item_id" status_code=500 request_id=f71c2b2a-43ee-4adb-817b-58d944153e1f method=POST path=/api/normalization/apply-patterns
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/normalization/apply-patterns 500 519.2┬╡s 358 [RequestID: f71c2b2a-43ee-4adb-817b-58d944153e1f]
[GIN] Request ID: f71c2b2a-43ee-4adb-817b-58d944153e1f
    integration_test.go:127: Expected status 200, got 500. Body: {"error":"Failed to apply patterns: ╨Т╨╜╤Г╤В╤А╨╡╨╜╨╜╤П╤П ╨╛╤И╨╕╨▒╨║╨░ ╤Б╨╡╤А╨▓╨╡╤А╨░: ╨╜╨╡ ╤Г╨┤╨░╨╗╨╛╤Б╤М ╨┐╤А╨╕╨╝╨╡╨╜╨╕╤В╤М ╨┐╨░╤В╤В╨╡╤А╨╜╤Л\nfailed to persist normalized name: failed to update normalized name via catalog_item: no such column: normalized_item_id","timestamp":"2025-11-26T00:48:49+03:00","request_id":"f71c2b2a-43ee-4adb-817b-58d944153e1f"}
=== RUN   TestFullNormalizationFlow/GetHistory
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/normalization/start 200 0s 106 [RequestID: 4e645748-fb68-442a-b3cd-0ffbb2faa2b1]
[GIN] Request ID: 4e645748-fb68-442a-b3cd-0ffbb2faa2b1
[2025/11/26 - 00:48:49] 192.0.2.1 [GET] /api/normalization/history?session_id=4 200 0s 257 [RequestID: 0fac1947-9bda-4809-9141-1cb5056379c4]
[GIN] Request ID: 0fac1947-9bda-4809-9141-1cb5056379c4
--- FAIL: TestFullNormalizationFlow (0.02s)
    --- PASS: TestFullNormalizationFlow/StartNormalization (0.00s)
    --- FAIL: TestFullNormalizationFlow/ApplyPatterns (0.00s)
    --- PASS: TestFullNormalizationFlow/GetHistory (0.00s)
=== RUN   TestNormalizationWithRevert
2025/11/26 00:48:49 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:49 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:49 Creating indexes for stage tracking...
2025/11/26 00:48:49 Stage indexes created: 25 new indexes
2025/11/26 00:48:49 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:49 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:49 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:49 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:49 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:49 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:49 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:49 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:49 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:49 No saved config found, using default config
2025/11/26 00:48:49 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:49   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:49   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:49   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:49   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:49   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:49   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:49   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:49   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:49   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:49   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:49   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:49   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:49   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:49   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:49   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:49   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:49   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:49   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:49   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:49   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:49   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:49 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:49 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:49 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:49 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:49 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:49 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:49 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:49 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:49 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:49 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:49 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:49 [DEBUG] counterpartyHandler status: &{0xc00130cb70 0xc001468360 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:49 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:49 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/normalization/start 200 517.5┬╡s 98 [RequestID: 8ab3b54b-fd77-4193-a5ce-3ea0b7ebf575]
[GIN] Request ID: 8ab3b54b-fd77-4193-a5ce-3ea0b7ebf575
2025/11/26 00:48:49 ERROR HTTP error error="Failed to apply patterns: ╨Т╨╜╤Г╤В╤А╨╡╨╜╨╜╤П╤П ╨╛╤И╨╕╨▒╨║╨░ ╤Б╨╡╤А╨▓╨╡╤А╨░: ╨╜╨╡ ╤Г╨┤╨░╨╗╨╛╤Б╤М ╨┐╤А╨╕╨╝╨╡╨╜╨╕╤В╤М ╨┐╨░╤В╤В╨╡╤А╨╜╤Л\nfailed to persist normalized name: failed to update normalized name via catalog_item: no such column: normalized_item_id" status_code=500 request_id=9b106342-21b1-43b8-ad03-11b763970ac3 method=POST path=/api/normalization/apply-patterns
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/normalization/apply-patterns 500 0s 358 [RequestID: 9b106342-21b1-43b8-ad03-11b763970ac3]
[GIN] Request ID: 9b106342-21b1-43b8-ad03-11b763970ac3
[2025/11/26 - 00:48:49] 192.0.2.1 [GET] /api/normalization/history?session_id=1 200 0s 249 [RequestID: db45b0fe-5461-4f70-af9e-a9776454be60]
[GIN] Request ID: db45b0fe-5461-4f70-af9e-a9776454be60
    integration_test.go:248: No stages to revert to
--- SKIP: TestNormalizationWithRevert (0.02s)
=== RUN   TestClassificationIntegration
2025/11/26 00:48:49 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:49 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:49 Creating indexes for stage tracking...
2025/11/26 00:48:49 Stage indexes created: 25 new indexes
2025/11/26 00:48:49 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:49 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:49 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:49 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
2025/11/26 00:48:49 ╨Ъ╨╛╨╜╤Д╨╕╨│╤Г╤А╨░╤Ж╨╕╤П ╨╕╤Б╤В╨╛╤З╨╜╨╕╨║╨░ ╨╛╨▒╨╜╨╛╨▓╨╗╨╡╨╜╨░: ╤В╨░╨▒╨╗╨╕╤Ж╨░=catalog_items, reference=reference, code=code, name=name
2025/11/26 00:48:49 ╨Э╨░╤З╨░╨╗╨╛ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 ╨Ю╤З╨╕╤Б╤В╨║╨░ ╤Б╤В╨░╤А╤Л╤Е ╨╖╨░╨┐╨╕╤Б╨╡╨╣ ╨╕╨╖ catalog_items...
2025/11/26 00:48:49 ╨Ю╤З╨╕╤Б╤В╨║╨░ ╨╖╨░╨▓╨╡╤А╤И╨╡╨╜╨░
2025/11/26 00:48:49 ╨Я╨╛╨╗╤Г╤З╨╡╨╜╨╕╨╡ ╨▓╤Б╨╡╤Е ╨╖╨░╨┐╨╕╤Б╨╡╨╣ ╨╕╨╖ catalog_items (ref=reference, code=code, name=name)...
2025/11/26 00:48:49 ╨Я╨╛╨╗╤Г╤З╨╡╨╜╨╛ 1 ╨╖╨░╨┐╨╕╤Б╨╡╨╣ ╨╕╨╖ catalog_items
2025/11/26 00:48:49 Warning: upload_id not specified and no session_id available, using default value 1 for checkpoint
2025/11/26 00:48:49 ╨У╤А╤Г╨┐╨┐╨╕╤А╨╛╨▓╨║╨░ ╨╖╨░╨┐╨╕╤Б╨╡╨╣...
2025/11/26 00:48:49 ╨б╨╛╨╖╨┤╨░╨╜╨╛ 1 ╨│╤А╤Г╨┐╨┐
2025/11/26 00:48:49 ╨Т╤Б╤В╨░╨▓╨║╨░ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨╛╨▓╨░╨╜╨╜╤Л╤Е ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 ╨Т╤Б╤В╨░╨▓╨╗╨╡╨╜╨╛ 1 ╨╖╨░╨┐╨╕╤Б╨╡╨╣ (╨▓╤Б╨╡╨│╨╛: 1)
2025/11/26 00:48:49 Checkpoint ╤Б╨╛╤Е╤А╨░╨╜╨╡╨╜: 1/1 ╨╖╨░╨┐╨╕╤Б╨╡╨╣ ╨╛╨▒╤А╨░╨▒╨╛╤В╨░╨╜╨╛ (100.0%)
2025/11/26 00:48:49 ╨Э╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╖╨░╨▓╨╡╤А╤И╨╡╨╜╨░ ╨╖╨░ 1.0464ms. ╨Т╤Б╨╡╨│╨╛ ╨╛╨▒╤А╨░╨▒╨╛╤В╨░╨╜╨╛: 1 ╨╖╨░╨┐╨╕╤Б╨╡╨╣
2025/11/26 00:48:49 Checkpoint ╤Г╨┤╨░╨╗╨╡╨╜ ╨┐╨╛╤Б╨╗╨╡ ╤Г╤Б╨┐╨╡╤И╨╜╨╛╨│╨╛ ╨╖╨░╨▓╨╡╤А╤И╨╡╨╜╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╨║╨╕
2025/11/26 00:48:49 тЬУ Checkpoint ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Г╨┤╨░╨╗╨╡╨╜ ╨┐╨╛╤Б╨╗╨╡ ╨╖╨░╨▓╨╡╤А╤И╨╡╨╜╨╕╤П ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕
2025/11/26 00:48:49 ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░...
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╤Н╤И╨╡╨╣...
2025/11/26 00:48:49 тЬУ ╨Ъ╤Н╤И╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П AI ╨║╨╗╨╕╨╡╨╜╤В╨╛╨▓...
2025/11/26 00:48:49 Warning: ARLIAI_API_KEY not set
2025/11/26 00:48:49 тЬУ AI ╨║╨╗╨╕╨╡╨╜╤В╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╨╛╨▓ ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕...
2025/11/26 00:48:49 ARLIAI_API_KEY ╨╜╨╡ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜, AI ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╤В╨║╨╗╤О╤З╨╡╨╜╨░
2025/11/26 00:48:49 тЬУ ╨Ъ╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨╜╨╛╤А╨╝╨░╨╗╨╕╨╖╨░╤Ж╨╕╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨▓...
2025/11/26 00:48:49 No saved config found, using default config
2025/11/26 00:48:49 тЬУ ╨Ь╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓: data\benchmarks.db
2025/11/26 00:48:49   ╨Я╨░╨┐╨║╨░ data ╨┐╤А╨╛╨▓╨╡╤А╨╡╨╜╨░/╤Б╨╛╨╖╨┤╨░╨╜╨░
2025/11/26 00:48:49   тЬУ ╨С╨Ф ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Б╨╛╨╖╨┤╨░╨╜╨░: data\benchmarks.db
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ BenchmarkService...
2025/11/26 00:48:49   тЬУ BenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationService...
2025/11/26 00:48:49   тЬУ NormalizationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyService...
2025/11/26 00:48:49   тЬУ CounterpartyService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientService...
2025/11/26 00:48:49   тЬУ ClientService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DatabaseService...
2025/11/26 00:48:49   тЬУ DatabaseService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ QualityService...
2025/11/26 00:48:49   тЬУ QualityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClassificationService...
2025/11/26 00:48:49   тЬУ ClassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SimilarityService...
2025/11/26 00:48:49   тЬУ SimilarityService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NotificationService...
2025/11/26 00:48:49   тЬУ NotificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReportService...
2025/11/26 00:48:49   тЬУ ReportService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ SnapshotService...
2025/11/26 00:48:49   тЬУ SnapshotService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ GISPService...
2025/11/26 00:48:49   тЬУ GISPService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ Processing1CService...
2025/11/26 00:48:49   тЬУ Processing1CService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ DuplicateDetectionService...
2025/11/26 00:48:49   тЬУ DuplicateDetectionService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ReclassificationService...
2025/11/26 00:48:49   тЬУ ReclassificationService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ NormalizationBenchmarkService...
2025/11/26 00:48:49   тЬУ NormalizationBenchmarkService ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П GOSTs ╨▒╨░╨╖╤Л ╨┤╨░╨╜╨╜╤Л╤Е...
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49   тЬУ GOSTs ╨▒╨░╨╖╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╕ ╤Б╨╡╤А╨▓╨╕╤Б ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ ╨б╨╡╤А╨▓╨╕╤Б╤Л ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╛╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╛╨▓...
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ╨▒╨░╨╖╨╛╨▓╨╛╨│╨╛ handler...
2025/11/26 00:48:49   тЬУ ╨С╨░╨╖╨╛╨▓╤Л╨╣ handler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ CounterpartyHandler...
2025/11/26 00:48:49   тЬУ CounterpartyHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49   ╨б╨╛╨╖╨┤╨░╨╜╨╕╨╡ ClientHandler...
2025/11/26 00:48:49   тЬУ ClientHandler ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Ю╨▒╤А╨░╨▒╨╛╤В╤З╨╕╨║╨╕ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│╨░...
2025/11/26 00:48:49 тЬУ ╨Ь╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╨╛╨╝╨┐╨╛╨╜╨╡╨╜╤В╤Л ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А╨░ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 тЬУ DI ╨║╨╛╨╜╤В╨╡╨╣╨╜╨╡╤А ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 Provider orchestrator initialized with strategy: first_success, timeout: 0s, multi-provider enabled: false
2025/11/26 00:48:49 Multi-provider client initialized with 0 active providers, 0 total channels
2025/11/26 00:48:49 ╨Я╨╛╨╕╤Б╨║╨╛╨▓╨╕╨║ ╤Н╤В╨░╨╗╨╛╨╜╨╛╨▓ ╤Г╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜
2025/11/26 00:48:49 Running migration: adding source_id field to gosts table...
2025/11/26 00:48:49 source_id column already exists, skipping migration
2025/11/26 00:48:49 тЬУ ConfigHandler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 тЬУ ╨Т╤Б╨╡ ╨║╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨╖╨░╨▓╨╕╤Б╨╕╨╝╨╛╤Б╤В╨╕ ╨▓╨░╨╗╨╕╨┤╨╕╤А╨╛╨▓╨░╨╜╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛
2025/11/26 00:48:49 [ensureHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 [buildHTTPHandler] ╨Э╨░╤З╨░╨╗╨╛ ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П HTTP handler
2025/11/26 00:48:49 Created missing classifier: Adata.kz (ID: 1)
2025/11/26 00:48:49 Created missing classifier: DaData.ru (ID: 2)
2025/11/26 00:48:49 Created missing classifier: ╨Ъ╨Я╨Т╨н╨Ф (ID: 3)
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> Adata.kz
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> DaData.ru
2025/11/26 00:48:49 Created project type classifier binding: nomenclature_counterparties -> ╨Ъ╨Я╨Т╨н╨Ф
2025/11/26 00:48:49 Initialized 3 default project type classifier bindings for nomenclature_counterparties
2025/11/26 00:48:49 [buildHTTPHandler] Handlers ╨╕╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Gin router ╤Б╨╛╨╖╨┤╨░╨╜
2025/11/26 00:48:49 [buildHTTPHandler] Middleware ╨┐╤А╨╕╨╝╨╡╨╜╨╡╨╜╤Л
2025/11/26 00:48:49 [buildHTTPHandler] Swagger routes ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [Routes] Config API routes registered: GET /api/config, PUT /api/config, POST /api/config, GET /api/config/full, GET /api/config/history
2025/11/26 00:48:49 [registerGinHandlers] ╨Я╤А╨╛╨▓╨╡╤А╨║╨░ clientHandler: true
2025/11/26 00:48:49 [registerGinHandlers] ╨а╨╡╨│╨╕╤Б╤В╤А╨░╤Ж╨╕╤П Clients API routes
2025/11/26 00:48:49 [Routes] тЬУ Clients API routes registered: POST /api/clients, GET /api/clients, GET /api/clients/:clientId, etc.
2025/11/26 00:48:49 [Routes] тЬУ Notifications API routes registered: POST /api/notifications, GET /api/notifications, etc.
2025/11/26 00:48:49 [DEBUG] counterpartyHandler status: &{0xc000486fd8 0xc0015a28a0 <nil> 0x7ff6d1ee4640} (nil=false)
2025/11/26 00:48:49 [Routes] тЬУ Counterparties API routes registered: GET /api/counterparties/all, GET /api/counterparties/all/export
2025/11/26 00:48:49 [buildHTTPHandler] Gin handlers ╨╖╨░╤А╨╡╨│╨╕╤Б╤В╤А╨╕╤А╨╛╨▓╨░╨╜╤Л
2025/11/26 00:48:49 [ensureHTTPHandler] тЬУ HTTP handler ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Б╨╛╨╖╨┤╨░╨╜
[2025/11/26 - 00:48:49] 192.0.2.1 [POST] /api/classification/classify 404 0s 19 [RequestID: 31122ef1-ccfd-492c-98d3-88c7fc7100cb]
[GIN] Request ID: 31122ef1-ccfd-492c-98d3-88c7fc7100cb
    integration_test.go:340: Expected status 200 or 400, got 404. Body: 404 page not found
--- FAIL: TestClassificationIntegration (0.02s)
=== RUN   TestNotificationsCRUDIntegrationSuite
2025/11/26 00:48:49 Running migration: creating normalization_sessions table...
2025/11/26 00:48:49 Normalization sessions migration completed: table and 6 indexes created
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_AllTypes
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_BulkOperations
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_CRUD_Flow
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_CombinedFilters
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_ConcurrentOperations
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_ForeignKeyConstraint
2025/11/26 00:48:49 ERROR HTTP error error="Failed to create notification: failed to save notification to database: failed to save notification: FOREIGN KEY constraint failed" status_code=500 request_id="" method=POST path=/api/notifications
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_InvalidJSON
2025/11/26 00:48:49 ERROR HTTP error error="Invalid request body: invalid character 'i' looking for beginning of object key string" status_code=400 request_id="" method=POST path=/api/notifications
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_InvalidType
2025/11/26 00:48:49 ERROR HTTP error error="invalid notification type: invalid_type. Allowed types: info, success, warning, error" status_code=400 request_id="" method=POST path=/api/notifications
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_Minimal
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_MissingMessage
2025/11/26 00:48:49 ERROR HTTP error error="message is required" status_code=400 request_id="" method=POST path=/api/notifications
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_MissingTitle
2025/11/26 00:48:49 ERROR HTTP error error="title is required" status_code=400 request_id="" method=POST path=/api/notifications
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_Success
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_WithClientID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Create_WithProjectID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_DeleteMultiple
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Delete_NotFound
2025/11/26 00:48:49 ERROR HTTP error error="Notification not found: failed to delete notification from database: notification with id 99999 not found" status_code=404 request_id="" method=DELETE path=/api/notifications/99999
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Delete_Success
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_Delete_VerifyRemoval
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_EmptyDatabase
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetAll_Success
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetEmptyResult
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_Empty
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_Success
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_WithClientID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_WithProjectID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadOnly
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithClientID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithCombinedFilters
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithInvalidLimit
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithInvalidOffset
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithLargeOffset
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithLimit
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithOffset
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithProjectID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_InvalidPathParameters
2025/11/26 00:48:49 ERROR HTTP error error="Invalid notification ID: abc (must be a positive integer)" status_code=400 request_id="" method=POST path=/api/notifications/abc/read
2025/11/26 00:48:49 ERROR HTTP error error="Invalid notification ID: xyz (must be a positive integer)" status_code=400 request_id="" method=DELETE path=/api/notifications/xyz
2025/11/26 00:48:49 ERROR HTTP error error="Invalid notification ID: -1 (must be a positive integer)" status_code=400 request_id="" method=POST path=/api/notifications/-1/read
2025/11/26 00:48:49 ERROR HTTP error error="Notification not found: failed to mark notification as read in database: notification with id 999999999 not found" status_code=404 request_id="" method=POST path=/api/notifications/999999999/read
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_InvalidQueryParameters
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_LargeMetadata
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAllAsRead_Success
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAllAsRead_WithClientID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAllAsRead_WithProjectID
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsReadAlreadyRead
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsRead_AlreadyRead
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsRead_NotFound
2025/11/26 00:48:49 ERROR HTTP error error="Notification not found: failed to mark notification as read in database: notification with id 99999 not found" status_code=404 request_id="" method=POST path=/api/notifications/99999/read
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsRead_Success
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MetadataComplexStructures
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MultipleClients
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_MultipleProjects
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_PaginationEdgeCases
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_PaginationWithLargeDataset
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_ReadStatus_Persistence
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_ResponseMetadata
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_SpecialCharacters
=== RUN   TestNotificationsCRUDIntegrationSuite/TestNotification_WhitespaceOnlyFields
2025/11/26 00:48:49 ERROR HTTP error error="title is required" status_code=400 request_id="" method=POST path=/api/notifications
2025/11/26 00:48:49 ERROR HTTP error error="message is required" status_code=400 request_id="" method=POST path=/api/notifications
--- PASS: TestNotificationsCRUDIntegrationSuite (0.02s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_AllTypes (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_BulkOperations (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_CRUD_Flow (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_CombinedFilters (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_ConcurrentOperations (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_ForeignKeyConstraint (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_InvalidJSON (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_InvalidType (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_Minimal (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_MissingMessage (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_MissingTitle (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_Success (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_WithClientID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Create_WithProjectID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_DeleteMultiple (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Delete_NotFound (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Delete_Success (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_Delete_VerifyRemoval (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_EmptyDatabase (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetAll_Success (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetEmptyResult (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_Empty (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_Success (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_WithClientID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadCount_WithProjectID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetUnreadOnly (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithClientID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithCombinedFilters (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithInvalidLimit (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithInvalidOffset (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithLargeOffset (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithLimit (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithOffset (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_GetWithProjectID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_InvalidPathParameters (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_InvalidQueryParameters (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_LargeMetadata (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAllAsRead_Success (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAllAsRead_WithClientID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAllAsRead_WithProjectID (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsReadAlreadyRead (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsRead_AlreadyRead (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsRead_NotFound (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MarkAsRead_Success (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MetadataComplexStructures (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MultipleClients (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_MultipleProjects (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_PaginationEdgeCases (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_PaginationWithLargeDataset (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_ReadStatus_Persistence (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_ResponseMetadata (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_SpecialCharacters (0.00s)
    --- PASS: TestNotificationsCRUDIntegrationSuite/TestNotification_WhitespaceOnlyFields (0.00s)
=== RUN   TestQualityProjectStats_RealData
2025/11/26 00:48:49 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:49 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:49 Creating indexes for stage tracking...
2025/11/26 00:48:49 Stage indexes created: 25 new indexes
2025/11/26 00:48:49 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:49 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:49 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:49 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:50 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:50 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:50 Creating indexes for stage tracking...
2025/11/26 00:48:50 Stage indexes created: 25 new indexes
2025/11/26 00:48:50 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:50 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:50 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:50 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:51 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:51 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:51 Creating indexes for stage tracking...
2025/11/26 00:48:51 Stage indexes created: 25 new indexes
2025/11/26 00:48:51 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:51 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:51 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:51 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:52 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:52 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:52 Creating indexes for stage tracking...
2025/11/26 00:48:52 Stage indexes created: 25 new indexes
2025/11/26 00:48:52 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:52 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:52 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:52 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:52 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:53 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:53 Creating indexes for stage tracking...
2025/11/26 00:48:53 Stage indexes created: 25 new indexes
2025/11/26 00:48:53 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:53 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:53 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:53 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:53 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:53 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:53 Creating indexes for stage tracking...
2025/11/26 00:48:53 Stage indexes created: 25 new indexes
2025/11/26 00:48:53 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:53 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:53 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:54 INFO Creating new database connection path=D:\Programs\Temp\User\quality_integration_test_3427540456\project_db_1.db
2025/11/26 00:48:54 INFO Creating new database connection path=D:\Programs\Temp\User\quality_integration_test_3427540456\project_db_0.db
2025/11/26 00:48:54 INFO Creating new database connection path=D:\Programs\Temp\User\quality_integration_test_3427540456\project_db_3.db
2025/11/26 00:48:54 INFO Creating new database connection path=D:\Programs\Temp\User\quality_integration_test_3427540456\project_db_2.db
2025/11/26 00:48:54 INFO Creating new database connection path=D:\Programs\Temp\User\quality_integration_test_3427540456\project_db_4.db
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 INFO Successfully retrieved quality stats
2025/11/26 00:48:54 INFO Successfully retrieved quality stats
2025/11/26 00:48:54 INFO Successfully retrieved quality stats
2025/11/26 00:48:54 INFO Successfully retrieved quality stats
2025/11/26 00:48:54 INFO Successfully retrieved quality stats
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 1 changes applied, 1 already existed
    quality_project_integration_test.go:194: Expected 4 databases with data, got 5
    quality_project_integration_test.go:202: Successfully aggregated stats for 5 databases in 60.7131ms
    quality_project_integration_test.go:203: Total items: 285
--- FAIL: TestQualityProjectStats_RealData (4.73s)
=== RUN   TestQualityProjectStats_APIEndpoint
2025/11/26 00:48:54 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:54 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:54 Creating indexes for stage tracking...
2025/11/26 00:48:54 Stage indexes created: 25 new indexes
2025/11/26 00:48:54 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:54 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:54 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:54 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 INFO Creating new database connection path=D:\Programs\Temp\User\quality_api_test_3626216374\project_db1.db
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 INFO Successfully retrieved quality stats
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 0 columns added, 79 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 1 changes applied, 1 already existed
    quality_project_integration_test.go:314: API endpoint test passed. Response: map[average_quality:50 benchmark_count:0 benchmark_percentage:0 by_level:map[] databases:[map[database_id:1 database_name:Test Project DB database_path:D:\Programs\Temp\User\quality_api_test_3626216374\project_db1.db stats:map[average_quality:50 benchmark_count:0 benchmark_percentage:0 by_level:map[basic:map[avg_quality:50 count:1 percentage:100]] total_items:1]]] databases_count:1 databases_processed:1 total_items:1]
--- PASS: TestQualityProjectStats_APIEndpoint (1.25s)
=== RUN   TestQualityReportIntegration
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
=== RUN   TestQualityReportIntegration/GetQualityReport
2025/11/26 00:48:55 INFO Getting quality report upload_uuid=test-quality-uuid summary_only=false limit=0 offset=0
2025/11/26 00:48:55 INFO Successfully generated quality report upload_uuid=test-quality-uuid total_issues=0
=== RUN   TestQualityReportIntegration/GetQualityReport_SummaryOnly
2025/11/26 00:48:55 INFO Getting quality report upload_uuid=test-quality-uuid summary_only=true limit=0 offset=0
2025/11/26 00:48:55 INFO Successfully generated quality report upload_uuid=test-quality-uuid total_issues=0
--- PASS: TestQualityReportIntegration (0.04s)
    --- PASS: TestQualityReportIntegration/GetQualityReport (0.00s)
    --- PASS: TestQualityReportIntegration/GetQualityReport_SummaryOnly (0.00s)
=== RUN   TestQualityAnalysisIntegration
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
=== RUN   TestQualityAnalysisIntegration/StartQualityAnalysis
2025/11/26 00:48:55 INFO Starting quality analysis upload_uuid=test-analysis-uuid
2025/11/26 00:48:55 ERROR Failed to get upload for analysis upload_uuid=test-analysis-uuid error="failed to get upload by UUID: sql: database is closed"
--- PASS: TestQualityAnalysisIntegration (0.04s)
    --- PASS: TestQualityAnalysisIntegration/StartQualityAnalysis (0.00s)
=== RUN   TestQualityDashboardIntegration
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
=== RUN   TestQualityDashboardIntegration/GetQualityDashboard
2025/11/26 00:48:55 INFO Getting quality dashboard database_id=1 days=30 limit=10
2025/11/26 00:48:55 INFO Successfully generated quality dashboard database_id=1 trends_count=0 top_issues_count=0
--- PASS: TestQualityDashboardIntegration (0.03s)
    --- PASS: TestQualityDashboardIntegration/GetQualityDashboard (0.00s)
=== RUN   TestQualityIssuesIntegration
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
=== RUN   TestQualityIssuesIntegration/GetQualityIssues
2025/11/26 00:48:55 INFO Getting quality issues database_id=1
2025/11/26 00:48:55 INFO Found relevant uploads database_id=1 count=1
2025/11/26 00:48:55 INFO Retrieved quality issues database_id=1 total_issues=0
=== RUN   TestQualityIssuesIntegration/GetQualityIssues_WithFilters
2025/11/26 00:48:55 INFO Getting quality issues database_id=1
2025/11/26 00:48:55 INFO Found relevant uploads database_id=1 count=1
2025/11/26 00:48:55 INFO Retrieved quality issues database_id=1 total_issues=0
--- PASS: TestQualityIssuesIntegration (0.03s)
    --- PASS: TestQualityIssuesIntegration/GetQualityIssues (0.00s)
    --- PASS: TestQualityIssuesIntegration/GetQualityIssues_WithFilters (0.00s)
=== RUN   TestQualityTrendsIntegration
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
=== RUN   TestQualityTrendsIntegration/GetQualityTrends
2025/11/26 00:48:55 INFO Getting quality trends database_id=1 days=30
2025/11/26 00:48:55 INFO Successfully retrieved quality trends database_id=1 trends_count=0
--- PASS: TestQualityTrendsIntegration (0.03s)
    --- PASS: TestQualityTrendsIntegration/GetQualityTrends (0.00s)
=== RUN   TestQualityEndpoints_InvalidMethods
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
2025/11/26 00:48:55 Running migration: adding stage tracking fields to normalized_data...
2025/11/26 00:48:55 Migration completed: 79 columns added, 0 columns already existed
2025/11/26 00:48:55 Creating indexes for stage tracking...
2025/11/26 00:48:55 Stage indexes created: 25 new indexes
2025/11/26 00:48:55 Running migration: adding normalization_session_id to normalized_data...
2025/11/26 00:48:55 Session ID migration completed: 1 changes applied, 1 already existed
2025/11/26 00:48:55 Running migration: adding project_id to normalized_data...
2025/11/26 00:48:55 Project ID migration completed: 2 changes applied, 0 already existed
=== RUN   TestQualityEndpoints_InvalidMethods/POST_to_quality-report_should_fail
=== RUN   TestQualityEndpoints_InvalidMethods/GET_to_quality-analysis_should_fail
--- PASS: TestQualityEndpoints_InvalidMethods (0.03s)
    --- PASS: TestQualityEndpoints_InvalidMethods/POST_to_quality-report_should_fail (0.00s)
    --- PASS: TestQualityEndpoints_InvalidMethods/GET_to_quality-analysis_should_fail (0.00s)
FAIL
FAIL	httpserver/integration	8.628s
FAIL
