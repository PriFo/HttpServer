# –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ server.go –Ω–∞ Enterprise-—É—Ä–æ–≤–µ–Ω—å

## –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: 2025-01-21

## üéØ –¶–µ–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

1. **–£–ª—É—á—à–∏—Ç—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ—Å—Ç—å**: –†–∞–∑–±–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `server.go` (18000+ —Å—Ç—Ä–æ–∫) –Ω–∞ –º–æ–¥—É–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
2. **Enterprise-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã Clean Architecture –∏ DDD
3. **Dependency Injection**: –í–Ω–µ–¥—Ä–∏—Ç—å DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
4. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –û–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å unit-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
5. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –£–ø—Ä–æ—Å—Ç–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

- `server.go`: ~18000 —Å—Ç—Ä–æ–∫
- –í—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏: ~45 —Å–µ–∫—É–Ω–¥
- –í—ã—Å–æ–∫–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üèóÔ∏è –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
cmd/
‚îî‚îÄ‚îÄ server/
    ‚îî‚îÄ‚îÄ main.go                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

internal/
‚îú‚îÄ‚îÄ container/                 # DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚úÖ –°–û–ó–î–ê–ù
‚îÇ   ‚îî‚îÄ‚îÄ container.go
‚îú‚îÄ‚îÄ api/                       # Transport layer
‚îÇ   ‚îú‚îÄ‚îÄ handlers/              # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ –¥–æ–º–µ–Ω–∞–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ upload/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ normalization/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ quality/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ middleware/           # Enterprise middleware
‚îÇ   ‚îî‚îÄ‚îÄ routes/               # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ domain/                   # Business layer
‚îÇ   ‚îú‚îÄ‚îÄ models/              # –°—É—â–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å—ã (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
‚îÇ   ‚îú‚îÄ‚îÄ repositories/        # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚îÇ   ‚îî‚îÄ‚îÄ events/              # Domain events
‚îî‚îÄ‚îÄ infrastructure/          # Infrastructure layer
    ‚îú‚îÄ‚îÄ persistence/         # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
    ‚îú‚îÄ‚îÄ ai/                 # AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ cache/              # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚îî‚îÄ‚îÄ monitoring/         # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
```

## üìã –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê

- [x] –°–æ–∑–¥–∞—Ç—å DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (`internal/container/container.go`)
- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –¥–ª—è domain –∏ infrastructure
- [x] –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ –º–æ–¥–µ–ª–∏ –≤ `internal/domain/repositories/models.go`
- [x] –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –≤ `internal/domain/repositories/repositories.go`
- [x] –°–æ–∑–¥–∞—Ç—å domain bounded contexts (upload)
- [x] –°–æ–∑–¥–∞—Ç—å application use cases (upload)
- [x] –°–æ–∑–¥–∞—Ç—å infrastructure persistence layer (upload repository)
- [x] –°–æ–∑–¥–∞—Ç—å API handlers (upload)

### –§–∞–∑–∞ 2: –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (3-4 –¥–Ω—è)

- [ ] –í—ã–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–º–µ–Ω—ã:
  - `domain/upload` - –ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö 1C
  - `domain/normalization` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
  - `domain/quality` - –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞
  - `domain/classification` - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
  - `domain/counterparty` - —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ `domain/services`
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å domain events

### –§–∞–∑–∞ 3: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (4-5 –¥–Ω–µ–π)

- [ ] –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ö–µ–Ω–¥–ª–µ—Ä—ã –ø–æ –¥–æ–º–µ–Ω–∞–º:
  - `internal/api/handlers/upload/`
  - `internal/api/handlers/normalization/`
  - `internal/api/handlers/quality/`
  - –∏ —Ç.–¥.
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–±—Ä–∏–∫–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å–Ω—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é

### –§–∞–∑–∞ 4: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π (3-4 –¥–Ω—è)

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ `infrastructure/persistence`
- [ ] –í—ã–Ω–µ—Å—Ç–∏ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤ `infrastructure/ai`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `infrastructure/cache`

### –§–∞–∑–∞ 5: –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ middleware (2-3 –¥–Ω—è)

- [ ] –ú–æ–¥—É–ª—å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤ `internal/api/routes`
- [ ] Enterprise middleware –≤ `internal/api/middleware`
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º

## üîß –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

1. **–ì—Ä–∞–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –ø–æ–ª–æ–º–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞
2. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –í—Å–µ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–ø–∏–ª—è—Ü–∏—é –∏ –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
4. **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**: –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –∑–∞—Ç–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## üìà –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ—Å—Ç—å
- –í—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏: –£–º–µ–Ω—å—à–∏—Ç—å –Ω–∞ 40-60% (—Ü–µ–ª—å: 15-20 —Å–µ–∫—É–Ω–¥)
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è: –í—Å–µ –ø–∞–∫–µ—Ç—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–µ–Ω—ã

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
- –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–æ–≤: –ú–∞–∫—Å–∏–º—É–º 500 —Å—Ç—Ä–æ–∫ –Ω–∞ –ø–∞–∫–µ—Ç
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ù–µ –±–æ–ª–µ–µ 5-7 –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ –ø–∞–∫–µ—Ç
- –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å: Mock-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### Enterprise-–∫–∞—á–µ—Å—Ç–≤–æ
- Dependency Injection: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤–Ω–µ–¥—Ä–µ–Ω —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: –ß–µ—Ä–µ–∑ environment variables + config —Ñ–∞–π–ª—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: Structured logging —Å correlation ID
- –ú–µ—Ç—Ä–∏–∫–∏: Prometheus metrics –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üöÄ –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
1. –°–æ–∑–¥–∞–Ω DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (`internal/container/container.go`)
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è enterprise-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
3. –ù–∞—á–∞—Ç –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
2. –í—ã–Ω–æ—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### ‚è≥ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –¥–ª—è domain
2. –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ –º–æ–¥–µ–ª–∏
3. –ù–∞—á–∞—Ç—å –ø–µ—Ä–µ–Ω–æ—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ –¥–æ–º–µ–Ω–∞–º

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å 1C –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ –º–µ—Ä–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è


