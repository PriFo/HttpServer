# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –£–ª—É—á—à–µ–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–µ—Å—Å–∏—è–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `database/service_db.go`

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `GetStoppedSessions()` - –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏
- `GetSessionStatistics(projectID)` - –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–µ—Å—Å–∏—è–º –ø—Ä–æ–µ–∫—Ç–∞

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç:**
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Å—Å–∏–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Å—Å–∏–π –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º (running, stopped, completed, failed, timeout)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏

### 2. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–π

**–§–∞–π–ª:** `server/server.go`

–û–±–Ω–æ–≤–ª–µ–Ω `handleGetNormalizationSessions`:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏—è—Ö
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–µ—Å—Å–∏—è–º
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `can_resume: true` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π

**–û—Ç–≤–µ—Ç API —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç:**
```json
{
  "sessions": [...],
  "stopped_sessions": [
    {
      "id": 123,
      "project_database_id": 1,
      "database_name": "Test DB",
      "status": "stopped",
      "started_at": "2025-01-01T10:00:00Z",
      "finished_at": "2025-01-01T10:30:00Z",
      "can_resume": true
    }
  ],
  "session_statistics": {
    "total_sessions": 10,
    "running_sessions": 2,
    "stopped_sessions": 3,
    "completed_sessions": 4,
    "failed_sessions": 1,
    "timeout_sessions": 0,
    "last_session": {
      "id": 123,
      "status": "stopped",
      "started_at": "2025-01-01T10:00:00Z",
      "finished_at": "2025-01-01T10:30:00Z"
    }
  }
}
```

### 3. ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

**–§–∞–π–ª:** `normalization/counterparty_normalizer.go`

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `sendStructuredEvent` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö JSON —Å–æ–±—ã—Ç–∏–π:
- `start` - –Ω–∞—á–∞–ª–æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- `duplicates_found` - –Ω–∞–π–¥–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã
- `processing_started` - –Ω–∞—á–∞—Ç–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- `progress` - –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `completed` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏—è:**
```json
{
  "type": "progress",
  "timestamp": "2025-01-01T10:00:00Z",
  "client_id": 1,
  "project_id": 1,
  "data": {
    "processed": 50,
    "total": 100,
    "progress_percent": 50.0,
    "benchmark_matches": 10,
    "enriched_count": 5,
    "duplicate_groups": 3
  }
}
```

## üìä API Endpoints

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

**GET** `/api/clients/{clientId}/projects/{projectId}/normalization/sessions`

**–û—Ç–≤–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç:**
- `sessions` - –≤—Å–µ —Å–µ—Å—Å–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- `stopped_sessions` - –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `session_statistics` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–µ—Å—Å–∏—è–º

### –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏

**POST** `/api/clients/{clientId}/projects/{projectId}/normalization/sessions/{sessionId}/resume`

–í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é, –ø—Ä–æ–ø—É—Å–∫–∞—è —É–∂–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤.

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Å—Å–∏–∏

**POST** `/api/clients/{clientId}/projects/{projectId}/normalization/sessions/{sessionId}/stop`

–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:** –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö —Å–µ—Å—Å–∏—è—Ö –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–∞—Ö
2. **–£–¥–æ–±—Å—Ç–≤–æ:** –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –¥–ª—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–µ—Å—Å–∏—è–º –ø—Ä–æ–µ–∫—Ç–∞
4. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:** –£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º
5. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

```bash
curl http://localhost:9999/api/clients/1/projects/1/normalization/sessions
```

### –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é

```bash
curl -X POST http://localhost:9999/api/clients/1/projects/1/normalization/sessions/123/resume
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é

```bash
curl -X POST http://localhost:9999/api/clients/1/projects/1/normalization/sessions/123/stop
```

## ‚úÖ –°—Ç–∞—Ç—É—Å

–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–µ—Å—Å–∏—è–º
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏—è—Ö
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ API –¥–ª—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö PRODUCTION

