# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É Normalization Domain

## –î–∞—Ç–∞: 2025-01-21

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Normalization Domain

### üìÅ –°–æ–∑–¥–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
internal/
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îî‚îÄ‚îÄ normalization/
‚îÇ       ‚îú‚îÄ‚îÄ service.go          # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å domain service
‚îÇ       ‚îú‚îÄ‚îÄ service_impl.go     # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è domain service
‚îÇ       ‚îî‚îÄ‚îÄ errors.go           # Domain –æ—à–∏–±–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ application/
‚îÇ   ‚îî‚îÄ‚îÄ normalization/
‚îÇ       ‚îî‚îÄ‚îÄ usecase.go          # Application use cases
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ normalization/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ handler.go      # HTTP handlers
‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ       ‚îî‚îÄ‚îÄ normalization_routes.go # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îÇ
‚îî‚îÄ‚îÄ infrastructure/
    ‚îî‚îÄ‚îÄ persistence/
        ‚îî‚îÄ‚îÄ normalization_repository.go # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```

## üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Domain Layer
- ‚úÖ `Service` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `service` —Å –±–∞–∑–æ–≤–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π
- ‚úÖ Domain –æ—à–∏–±–∫–∏
- ‚úÖ Domain –º–æ–¥–µ–ª–∏ (NormalizationProcess, NormalizedEntity, etc.)

### Application Layer
- ‚úÖ `UseCase` –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É domain –∏ infrastructure
- ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã use cases —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

### Infrastructure Layer
- ‚úÖ `NormalizationRepository` - –±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ TODO (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º normalizer)

### Presentation Layer
- ‚úÖ HTTP handlers –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö normalization endpoints:
  - `HandleStartProcess` - POST /api/normalize/start
  - `HandleGetProcessStatus` - GET /api/normalization/status
  - `HandleStopProcess` - POST /api/normalization/stop
  - `HandleGetActiveProcesses` - GET /api/normalization/processes/active
  - `HandleNormalizeName` - POST /api/normalization/normalize-name
  - `HandleGetStatistics` - GET /api/normalization/stats
  - `HandleGetProcessHistory` - GET /api/normalization/history

## üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

Normalization domain –∏–º–µ–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `normalization.Normalizer`:
- –ú–µ—Ç–æ–¥—ã `NormalizeName`, `NormalizeEntity`, `BatchNormalize` —Ç—Ä–µ–±—É—é—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å AI –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å `VersionedNormalizationPipeline`
- –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–≤—è–∑–∞–Ω—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

### TODO –¥–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Normalizer**:
   - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –Ω–∞ `normalization.Normalizer` –≤ domain service
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BenchmarkService**:
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –≤ —ç—Ç–∞–ª–æ–Ω–∞—Ö –ø–µ—Ä–µ–¥ AI –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π

3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**:
   - –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã/—Å—Ö–µ–º—É –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

4. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**:
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å `VersionedNormalizationPipeline`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Å—Å–∏—è–º–∏

## üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

- ‚úÖ `internal/domain/normalization` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ `internal/application/normalization` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ `internal/infrastructure/persistence` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (—Å TODO –º–µ—Ç–æ–¥–∞–º–∏)
- ‚úÖ `internal/api/handlers/normalization` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ `internal/api/routes` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

### –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- ‚úÖ Handlers —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã

### –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞:
- ‚ö†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `normalization.Normalizer`
- ‚ö†Ô∏è –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- ‚ö†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BenchmarkService
- ‚ö†Ô∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìà –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –ó–∞–≤–µ—Ä—à–µ–Ω–æ:
1. ‚úÖ Upload Domain - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
2. ‚úÖ Normalization Domain - –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞

### –í –ø—Ä–æ—Ü–µ—Å—Å–µ:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ server.go

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. Quality Domain
2. Classification Domain
3. Counterparty Domain

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Normalization Domain —Å–æ–∑–¥–∞–Ω–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

