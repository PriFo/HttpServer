# –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è handlers: –£–ª—É—á—à–µ–Ω–∏—è

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `project_type`

**–§–∞–π–ª:** `server/handlers/clients.go` - `CreateClientProject`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è `project_type`

**–î–æ:**
```go
if req.Name == "" {
    h.baseHandler.HandleHTTPError(w, r, NewValidationError("–ø–æ–ª–µ 'name' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è", nil))
    return
}
```

**–ü–æ—Å–ª–µ:**
```go
if req.Name == "" {
    h.baseHandler.HandleHTTPError(w, r, NewValidationError("–ø–æ–ª–µ 'name' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è", nil))
    return
}

if req.ProjectType == "" {
    h.baseHandler.HandleHTTPError(w, r, NewValidationError("–ø–æ–ª–µ 'project_type' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è", nil))
    return
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –Ω–æ–≤—ã–π handler —Ç—Ä–µ–±—É–µ—Ç `project_type`, –∫–∞–∫ –∏ legacy handler.

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `server/handlers/clients.go` - `CreateProjectDatabase`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∏–º–µ–Ω–∏ –∏ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É

**–î–æ:**
```go
// –°–æ–∑–¥–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å
database, err := h.clientService.CreateProjectDatabase(...)
```

**–ü–æ—Å–ª–µ:**
```go
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –∏–ª–∏ –ø—É—Ç–µ–º –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
existingDatabases, err := h.clientService.GetProjectDatabases(r.Context(), clientID, projectID)
if err == nil {
    for _, existingDB := range existingDatabases {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –ø–æ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É
        if existingDB.Name == req.Name || (filePath != "" && existingDB.FilePath == filePath) {
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–∞
            h.baseHandler.WriteJSONResponse(w, r, existingDB, http.StatusOK)
            return
        }
    }
}

// –°–æ–∑–¥–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å
database, err := h.clientService.CreateProjectDatabase(...)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –Ω–æ–≤—ã–π handler –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, –∫–∞–∫ –∏ legacy handler.

## üìã –°—Ä–∞–≤–Ω–µ–Ω–∏–µ handlers

### CreateClientProject

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ù–æ–≤—ã–π handler | Legacy handler | –°—Ç–∞—Ç—É—Å |
|----------|---------------|---------------|--------|
| –í–∞–ª–∏–¥–∞—Ü–∏—è `name` | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |
| –í–∞–ª–∏–¥–∞—Ü–∏—è `project_type` | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |

### CreateProjectDatabase

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ù–æ–≤—ã–π handler | Legacy handler | –°—Ç–∞—Ç—É—Å |
|----------|---------------|---------------|--------|
| –í–∞–ª–∏–¥–∞—Ü–∏—è `name` | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |
| –í–∞–ª–∏–¥–∞—Ü–∏—è `file_path` | ‚úÖ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | ‚úÖ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) | ‚ö†Ô∏è –†–∞–∑–ª–∏—á–∏–µ –¥–æ–ø—É—Å—Ç–∏–º–æ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ | ‚úÖ | ‚úÖ | ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ |
| –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ uploads | ‚ùå | ‚úÖ | ‚ö†Ô∏è –†–∞–∑–ª–∏—á–∏–µ –¥–æ–ø—É—Å—Ç–∏–º–æ |

## ‚ö†Ô∏è –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Ä–∞–∑–ª–∏—á–∏—è

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è `file_path` –≤ CreateProjectDatabase

**–ù–æ–≤—ã–π handler:** `file_path` –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω (—Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –ø–æ–∑–∂–µ)
**Legacy handler:** `file_path` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –ù–æ–≤—ã–π handler –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î –±–µ–∑ —Ñ–∞–π–ª–∞, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.

### 2. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ uploads

**–ù–æ–≤—ã–π handler:** –ù–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ñ–∞–π–ª—ã
**Legacy handler:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ `data/uploads/`

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–º –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö. –≠—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ –¥–æ–ø—É—Å—Ç–∏–º–æ, —Ç–∞–∫ –∫–∞–∫:
- –ù–æ–≤—ã–π handler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è API, –≥–¥–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —É–∂–µ –∏–∑–≤–µ—Å—Ç–µ–Ω
- Legacy handler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## ‚úÖ –í—ã–≤–æ–¥—ã

1. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞:** –û–±–∞ handler —Ç—Ä–µ–±—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–∞:** –ù–æ–≤—ã–π handler —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
3. ‚ö†Ô∏è **–†–∞–∑–ª–∏—á–∏—è –¥–æ–ø—É—Å—Ç–∏–º—ã:** –†–∞–∑–ª–∏—á–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–æ–≤ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –∏–º–µ—é—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã. –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Ä–∞–∑–ª–∏—á–∏—è –∏–º–µ—é—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

