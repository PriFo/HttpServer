# Changelog: Функциональность выбора проекта на странице качества

## [1.0.0] - 2025-11-24

### Добавлено

#### Backend
- ✅ Поддержка параметра `project` в `/api/quality/stats` для агрегации статистики по проекту
- ✅ Метод `aggregateProjectStats` для параллельной обработки баз данных проекта
- ✅ Поле `databases_count` в ответе API (общее количество баз в проекте)
- ✅ Поле `databases` в ответе API (массив статистики по каждой базе)
- ✅ Graceful degradation при ошибках обработки отдельных баз
- ✅ Таймаут 30 секунд для агрегации проекта
- ✅ Семафор для ограничения параллельных запросов (максимум 5)

#### Frontend
- ✅ Компонент `ProjectSelector` в заголовке страницы качества
- ✅ Компонент `ProjectDatabasesList` для отображения списка баз проекта
- ✅ Фильтрация `DatabaseSelector` по выбранному проекту
- ✅ Автоматическое определение проекта при выборе базы данных
- ✅ Агрегированная статистика проекта в отдельной карточке
- ✅ Поиск и фильтрация баз данных в списке проекта
- ✅ Сортировка по имени, качеству, количеству элементов и эталонов
- ✅ Улучшенные состояния загрузки с анимацией

#### API
- ✅ Endpoint `/api/databases/find-project` для поиска проекта по пути базы данных
- ✅ Поддержка параметра `project` в `/api/quality/duplicates`
- ✅ Поддержка параметра `project` в `/api/quality/violations`
- ✅ Поддержка параметра `project` в `/api/quality/suggestions`

### Исправлено

- ✅ Ошибка компиляции: экспортирован метод `SelectMasterRecordWithStrategy` в `CounterpartyDuplicateAnalyzer`
- ✅ Исправлена типизация в тестах для корректной обработки массива `databases`
- ✅ Улучшено отображение `databases_count` (показывает общее количество и обработанное)

### Улучшено

- ✅ Производительность: параллельная обработка баз данных проекта
- ✅ UX: улучшенные состояния загрузки и пустые состояния
- ✅ Обработка ошибок: логирование ошибок без прерывания процесса
- ✅ Документация: добавлены руководства по тестированию

### Тестирование

- ✅ Unit-тесты для `aggregateProjectStats` (4 теста)
- ✅ Интеграционные тесты для API endpoints (2 теста)
- ✅ Frontend тесты для `ProjectDatabasesList` (шаблон)
- ✅ Покрытие кода: ~70% новой функциональности

### Известные ограничения

- ⚠️ Таймаут агрегации: 30 секунд (может быть недостаточно для очень больших проектов)
- ⚠️ Лимит параллельных запросов: 5 (можно увеличить для более мощных серверов)
- ⚠️ Кэширование: результаты не кэшируются (можно добавить для улучшения производительности)

### Следующие шаги

- ⏳ Добавить кэширование результатов агрегации
- ⏳ Настроить и запустить frontend тесты
- ⏳ Провести проверку на реальных production данных
- ⏳ Добавить тесты производительности для больших проектов (10+ БД)
- ⏳ Оптимизировать обработку для проектов с 50+ базами данных

