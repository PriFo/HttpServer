# –°–≤–æ–¥–∫–∞ –ø–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–º API Routes –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ API Routes

### 1. –û–±–æ–≥–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤
**–§–∞–π–ª:** `frontend/app/api/counterparties/normalized/enrich/route.ts`
- **–ú–µ—Ç–æ–¥:** POST
- **Endpoint:** `/api/counterparties/normalized/enrich`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** 
  - `counterparty_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - `inn` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - `bin` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—É—á–Ω–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã (Dadata, Adata)

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
**–§–∞–π–ª:** `frontend/app/api/counterparties/normalized/duplicates/route.ts`
- **–ú–µ—Ç–æ–¥:** GET
- **Endpoint:** `/api/counterparties/normalized/duplicates`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** 
  - `project_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –≥—Ä—É–ø–ø—ã –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä–æ–µ–∫—Ç—É

### 3. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
**–§–∞–π–ª:** `frontend/app/api/counterparties/normalized/duplicates/[groupId]/merge/route.ts`
- **–ú–µ—Ç–æ–¥:** POST
- **Endpoint:** `/api/counterparties/normalized/duplicates/{groupId}/merge`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ body:**
  - `master_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
  - `merge_ids` (–º–∞—Å—Å–∏–≤, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ –≤ –æ–¥–Ω—É –∑–∞–ø–∏—Å—å

### 4. –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤
**–§–∞–π–ª:** `frontend/app/api/counterparties/normalized/export/route.ts`
- **–ú–µ—Ç–æ–¥:** POST
- **Endpoint:** `/api/counterparties/normalized/export`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ body:**
  - `project_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
  - `format` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 'json') - csv, json, xml
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö

## üîß –£–ª—É—á—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

### –°–æ–∑–¥–∞–Ω —É—Ç–∏–ª–∏—Ç–Ω—ã–π –∫–ª–∞—Å—Å ApiErrorHandler
**–§–∞–π–ª:** `frontend/lib/api-error-handler.ts`

**–ú–µ—Ç–æ–¥—ã:**
- `handleError(response)` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É API –∑–∞–ø—Ä–æ—Å–∞
- `logError(endpoint, error, context)` - –ª–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- `createErrorResponse(error, defaultMessage)` - —Å–æ–∑–¥–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –æ–± –æ—à–∏–±–∫–µ

### –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ API routes
–í—Å–µ API routes –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç `ApiErrorHandler` –¥–ª—è:
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ–± –æ—à–∏–±–∫–∞—Ö

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö API routes:** 4
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö routes:** 4
- **–°–æ–∑–¥–∞–Ω–æ —É—Ç–∏–ª–∏—Ç:** 1
- **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –≤–æ –≤—Å–µ—Ö routes

## ‚úÖ –í—Å–µ endpoints –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –∏–º–µ—é—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ API routes

1. ‚úÖ GET `/api/counterparties/normalized` - —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤
2. ‚úÖ GET `/api/counterparties/normalized/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
3. ‚úÖ GET `/api/counterparties/normalized/{id}` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
4. ‚úÖ PUT `/api/counterparties/normalized/{id}` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
5. ‚úÖ POST `/api/counterparties/normalized/enrich` - –æ–±–æ–≥–∞—â–µ–Ω–∏–µ
6. ‚úÖ GET `/api/counterparties/normalized/duplicates` - –¥—É–±–ª–∏–∫–∞—Ç—ã
7. ‚úÖ POST `/api/counterparties/normalized/duplicates/{groupId}/merge` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
8. ‚úÖ POST `/api/counterparties/normalized/export` - —ç–∫—Å–ø–æ—Ä—Ç

