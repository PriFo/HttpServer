# –£–ª—É—á—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è API routes –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

## –î–∞—Ç–∞: 2025-01-26

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### `frontend/lib/logger.ts`
- ‚úÖ –ö–ª–∞—Å—Å `Logger` —Å —É—Ä–æ–≤–Ω—è–º–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARN, ERROR, FATAL)
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ (`logRequest`, `logResponse`)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –±—ç–∫–µ–Ω–¥–∞ (`logBackendError`)
- ‚úÖ –£—Ç–∏–ª–∏—Ç–∞ `withLogging` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –£—Ç–∏–ª–∏—Ç–∞ `createApiContext` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ë—É—Ñ–µ—Ä –ª–æ–≥–æ–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–∑–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è Sentry, LogRocket)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è development –∏ production
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ timestamp
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–µ–∫–∞ –æ—à–∏–±–æ–∫ –≤ development —Ä–µ–∂–∏–º–µ
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

### 2. –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

#### `frontend/lib/error-handler.ts`
- ‚úÖ –ö–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–±–ª–µ–º:
  - `ApiRouteError` - –æ–±—â–∞—è –æ—à–∏–±–∫–∞ API route
  - `BackendConnectionError` - –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±—ç–∫–µ–Ω–¥—É
  - `BackendResponseError` - –æ—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –±—ç–∫–µ–Ω–¥–∞
  - `ValidationError` - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  - `NotFoundError` - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `handleError` - –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `handleBackendResponse` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç –±—ç–∫–µ–Ω–¥–∞
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `handleFetchError` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ fetch –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: `validateRequired`, `validateNumber`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ–± –æ—à–∏–±–∫–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è development –∏ production
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–æ–≤ –æ—à–∏–±–æ–∫ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ API routes –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `list/route.ts` - —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ `files/route.ts` - —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –ë–î
3. ‚úÖ `backups/route.ts` - —Å–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
4. ‚úÖ `backups/[filename]/route.ts` - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
5. ‚úÖ `analytics/route.ts` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ë–î
6. ‚úÖ `history/route.ts` - –∏—Å—Ç–æ—Ä–∏—è –ë–î
7. ‚úÖ `pending/route.ts` - –æ–∂–∏–¥–∞—é—â–∏–µ –ë–î
8. ‚úÖ `scan/route.ts` - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
9. ‚úÖ `find-project/route.ts` - –ø–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –ë–î

#### –£–ª—É—á—à–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º route:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
```typescript
logger.logRequest('GET', '/api/databases/list', { clientId: '1' })
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
```typescript
logger.logResponse('GET', '/api/databases/list', 200, 150, { clientId: '1' })
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
```typescript
try {
  // –∫–æ–¥
} catch (error) {
  return handleError(error, { endpoint, clientId: '1' })
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```typescript
validateRequired(dbPath, 'path', context)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –±—ç–∫–µ–Ω–¥–∞
```typescript
return handleBackendResponse(
  response,
  endpoint,
  context,
  {
    allow404: true,
    defaultData: [],
    errorMessage: 'Failed to fetch data',
  }
)
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ
- –í—Å–µ routes –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫
- –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å

### 2. –û—Ç–ª–∞–¥–∫–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ development —Ä–µ–∂–∏–º–µ

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –õ–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å API
- –í–∏–¥–µ—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –æ—à–∏–±–æ–∫
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ endpoints

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ –≤ production
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫

## –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

### Development —Ä–µ–∂–∏–º
```
[2025-01-26T23:30:00.000Z] [INFO] HTTP GET /api/databases/list ‚Üí 200 (150ms)
Context: {"route":"/api/databases/list","method":"GET","duration":150}
```

### Production —Ä–µ–∂–∏–º
```
[2025-01-26T23:30:00.000Z] [INFO] HTTP GET /api/databases/list ‚Üí 200 (150ms)
```

## –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –æ–± –æ—à–∏–±–∫–µ
```json
{
  "error": "Failed to fetch database files",
  "status": 500,
  "code": "BACKEND_RESPONSE_ERROR",
  "timestamp": "2025-01-26T23:30:00.000Z",
  "details": "..." // —Ç–æ–ª—å–∫–æ –≤ development
}
```

## –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤

- ‚úÖ **5 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ**
- ‚ö†Ô∏è **15 —Ç–µ—Å—Ç–æ–≤ —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ç–≤–µ—Ç–æ–≤)
- üìù **–¢–µ—Å—Ç—ã –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
2. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º API routes
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ–∞–π–ª –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
6. ‚úÖ –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ API

## –°—Ç–∞—Ç—É—Å

‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç**
‚úÖ **–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç**
‚úÖ **–í—Å–µ API routes –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω—ã**
‚ö†Ô∏è **–¢–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ç–≤–µ—Ç–æ–≤)

