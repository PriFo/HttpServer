# Исправление проблемы с отображением статистики баз данных

## Проблема

В интерфейсе показывались нули по всем статистикам (выгрузок, справочников, записей) для базы данных, хотя база данных существует и имеет размер 3.31 MB.

## Причина

Функция `GetUploadStatsByDatabaseID` искала записи в основной базе данных (service.db), используя `database_id` из таблицы `project_databases`. Но данные (uploads, catalogs, catalog_items) могут находиться напрямую в файле базы данных проекта, а не в основной БД.

## Решение

Добавлена новая функция `GetUploadStatsFromDatabaseFile`, которая:
1. Подключается напрямую к файлу БД проекта
2. Считает количество записей в таблицах `uploads`, `catalogs`, `catalog_items`
3. Возвращает статистику с обработкой ошибок (если таблицы не существуют, возвращает нули)

Модифицированы функции:
- `GetUploadStatsByDatabaseID` - добавлен комментарий о возможности fallback
- `GetDatabaseAnalytics` в `database_service.go` - использует fallback на файл БД при нулевой статистике
- `GetProjectDatabase` в `clients.go` - использует fallback на файл БД при нулевой статистике

## Изменения в коде

### database/db.go
- Добавлена функция `GetUploadStatsFromDatabaseFile(dbPath string)`
- Добавлены импорты `os` и `errors`
- Улучшена обработка ошибок с использованием `errors.Is`
- Добавлена обработка NULL значений для `avg_items_per_upload`

### server/services/database_service.go
- Модифицирована функция `GetDatabaseAnalytics` для использования fallback на файл БД
- Добавлена проверка нулевой статистики перед fallback
- Добавлено логирование при использовании статистики из файла

### server/handlers/clients.go
- Модифицирована функция `GetProjectDatabase` для использования fallback на файл БД
- Добавлена проверка нулевой статистики перед fallback
- Используется type assertion для безопасной проверки значений

## Как это работает

1. Сначала система пытается получить статистику из основной БД по `database_id`
2. Если статистика нулевая (все значения = 0), система проверяет наличие `file_path`
3. Если `file_path` указан, система подключается к файлу БД проекта
4. Считает записи напрямую из таблиц в файле БД (с обработкой отсутствующих таблиц)
5. Использует статистику из файла, если она больше нуля

## Обработка ошибок

- Если файл БД не существует - возвращается ошибка
- Если таблицы не существуют - возвращаются нули (не ошибка)
- Если произошла ошибка при подключении - возвращается ошибка
- Все ошибки оборачиваются с контекстом для отладки

## Результат

Теперь статистика будет корректно отображаться даже если данные находятся только в файле БД проекта, а не в основной БД. Система автоматически определяет источник данных и использует наиболее актуальную информацию.

